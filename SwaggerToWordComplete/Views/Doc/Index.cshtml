
@{
    Layout = null;
}
<!doctype html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="utf-8">
    <title>API</title>
    <style>
        body {
            font-family: Tahoma, sans-serif;
            background: #f0f2f5;
            padding: 40px;
        }

        .tabs {
            width: 900px;
            margin: auto;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .tab-buttons {
            display: flex;
            background: #e9ecef;
        }

            .tab-buttons button {
                flex: 1;
                padding: 14px;
                background: none;
                border: none;
                cursor: pointer;
                font-size: 15px;
                font-weight: bold;
            }

                .tab-buttons button.active {
                    background: #fff;
                    border-bottom: 3px solid #007bff;
                    color: #007bff;
                }

        .tab {
            display: none;
            padding: 25px;
        }

            .tab.active {
                display: block;
            }

        label {
            margin-top: 10px;
            font-weight: bold;
            display: block;
        }

        input, textarea, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 6px;
            margin-bottom: 10px;
        }

        .submit-area {
            padding: 25px;
            text-align: center;
        }

        button.submit {
            background: #007bff;
            color: #fff;
            padding: 14px;
            width: 70%;
            border-radius: 8px;
            border: none;
            cursor: pointer;
        }
    </style>
</head>
<body>

    @if (TempData["Error"] != null)

    {
        <div style="max-width:900px;margin:auto;color:#b71c1c;background:#ffecec;padding:12px;border-radius:6px">@TempData["Error"]</div>
    }

    <form method="post" action="/Doc/Generate" enctype="multipart/form-data">

        <div class="tabs">

            <div class="tab-buttons">
                <button type="button" class="active" onclick="openTab(0)">File</button>
                <button type="button" onclick="openTab(1)">Metadata</button>
                <button type="button" onclick="openTab(2)">Setting Word</button>
                <button type="button" onclick="openTab(3)">Font / RTL</button>
                <button type="button" onclick="openTab(4)">Advance Setting</button>
            </div>

            <!-- TAB 1 -->
            <div class="tab active">
                <label>Swagger (JSON)</label>
                <input type="file" name="Swagger" required />

                <label>Change Log</label>
                <textarea name="Changelog" rows="4">
                    
                    [{
                    "version": "1.0.0",
                    "date": "2025-11-01",
                    "developer": "",
                    "notes": ""
                  }]
                  </textarea>

                <!-- IncludeExamples -->
                <label>Include Examples?</label>
             
                <input type="checkbox" name="IncludeExamples" />

                <!-- AuthRequired -->
                <label>Auth Required?</label>
             
                <input type="checkbox" name="AuthRequired" id="AuthRequired" onclick="toggleAuthBox()" />

                <div id="authBox" style="display:none;">
                    <label>Name of Authorization</label>
                    <input name="AuthHeader" value="Authorization" />

                    <label>Default value</label>
                    <input name="AuthValue" value="Bearer {TOKEN}" />
                </div>
            </div>

            <!-- TAB 2 -->
            <div class="tab">
                <label>Author</label>
                <input name="Author" />

                <label>For</label>
                <input name="For" />

                <label>Intro</label>
                <textarea name="Intro"></textarea>

                <label>Shared Response Model</label>
                <textarea name="SharedResponseModel"></textarea>

                <label>Shared Errors</label>
                <textarea name="SharedErrors"></textarea>

                <label>Filter Methods</label>
                <input name="Methods" />
            </div>

            <!-- TAB 3 -->
            <div class="tab">
                <label>H1 Size</label>
                <input type="number" name="H1" value="18" />

                <label>H2 Size</label>
                <input type="number" name="H2" value="16" />

                <label>H3 Size</label>
                <input type="number" name="H3" value="14" />

                <label>Body Size</label>
                <input type="number" name="BodySize" value="12" />

                <label>Head Color</label>
                <input type="color" name="HeadColor" value="#000000" />
            </div>

            <!-- TAB 4 -->
            <div class="tab">
                <label>Font</label>
                <select name="Font">
                    <option value="Tahoma">Tahoma</option>
                    <option value="B Nazanin">B Nazanin</option>
                    <option value="IRANSans">IRANSans</option>
                    <option value="Calibri">Calibri</option>
                </select>

                <label>Direction</label>
                <select name="Rtl">
                    <option value="rtl">RTL</option>
                    <option value="ltr">LTR</option>
                </select>

                <label>Title</label>
                <input name="Title" value="API Documentation" />

                <label>Title All</label>
                <input name="Title_all" value="اطلاعات کلی" />

                <label>Title Intro</label>
                <input name="TitleIntro" value="مقدمه مستند" />

                <label>Title Shared Response Model</label>
                <input name="TitleSharedResponseModel" value="مدل خروجی مشترک" />

                <label>Title Shared Errors</label>
                <input name="TitleSharedErrors" value="مدل خروجی خطا" />

                <label>Index Title</label>
                <input name="IndexTitle" value="فهرست متدها (Index)" />

                <label>ChangeLog Title</label>
                <input name="ChangelogTitle" value="لیست تغییرات (Change Log)" />

                <label>Table of Contents Title</label>
                <input name="TitleTableOfContents" value="فهرست" />
            </div>

            <!-- TAB 5 -->
            <div class="tab">
                <label>Top Margin</label>
                <input name="MTop" value="720" />

                <label>Bottom Margin</label>
                <input name="MBottom" value="720" />

                <label>Left Margin</label>
                <input name="MLeft" value="720" />

                <label>Right Margin</label>
                <input name="MRight" value="720" />

                <label>Border Size</label>
                <input name="BorderSize" value="8" />

                <label>Border Color</label>
                <input type="color" name="BorderColor" value="#2B579A" />

                <label><input type="checkbox" name="Toc" checked /> Table of Contents</label>

                <label><input type="checkbox" name="PageNumber" checked  /> Page Number</label>
            </div>

            <div class="submit-area">
                <button class="submit" type="submit">Generate DOCX</button>
            </div>

        </div>
    </form>


    <script>
        function openTab(i) {
            document.querySelectorAll('.tab').forEach((tab, idx) => {
                tab.classList.toggle('active', idx === i);
            });
            document.querySelectorAll('.tab-buttons button').forEach((btn, idx) => {
                btn.classList.toggle('active', idx === i);
            });
        }

        function toggleAuthBox() {
            const c = document.getElementById("AuthRequired");
            document.getElementById('authBox').style.display = c.checked ? "block" : "none";
        }

        document.querySelector("form").addEventListener("submit", function () {

            // همه چک‌باکس‌ها را پیدا کن
            document.querySelectorAll("input[type='checkbox']").forEach(function (chk) {

                // اگر تیک خورده باشد → true
                if (chk.checked) {
                    chk.value = "true";
                }
                // اگر تیک نخورده باشد → false
                else {
                    // چون چک‌باکس تیک نخورده ارسال نمی‌شود، hidden می‌سازیم
                    let hidden = document.createElement("input");
                    hidden.type = "hidden";
                    hidden.name = chk.name;
                    hidden.value = "false";
                    document.querySelector("form").appendChild(hidden);
                }
            });
        });
    </script>

</body>
</html>
